[build]
builder = "NIXPACKS"

[build.nixpacksPlan.phases.setup]
# This is the "Nixpacks" way to ensure these run FIRST
nixPkgs = ["nodejs_22", "pnpm"]
cmds = ["pnpm install"]

[build.nixpacksPlan.phases.build]
# Run Prisma generate and then your build script
dependsOn = ["setup"]
cmds = [
  "pnpm --filter finance-tracker exec prisma generate",
  "pnpm build:app:finance-tracker"
]

[deploy]
buildCommand = "pnpm build:app:finance-tracker"
startCommand = "pnpm start:app:finance-tracker"